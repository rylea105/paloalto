---
- name: Check Palo Alto ready config
  hosts: localhost
  gather_facts: no
  collections:
  - paloaltonetworks.panos
  tasks:
  - name: get api key
    panos_api_key: 
      provider: 
          ip_address: "{{ ip_address }}"
          username: "{{ username }}"
          password: "{{ password }}"
    register: auth

  - name: wait for reboot
    panos_check:
        provider:
          ip_address: "{{ ip_address }}"
          api_key: "{{ auth.api_key }}"
        initial_delay: 60
        interval: 0
        timeout: 86400
    register: check

  - debug:
      var: check